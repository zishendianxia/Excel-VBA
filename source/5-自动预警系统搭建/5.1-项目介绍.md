# 5.1-项目介绍

```{admonition} 引言
本章依然采用一个项目的方式，介绍新的知识点。本章介绍的知识点如下：
- 文本解析
- 自动分发邮件
- 单元格样式设置
- 图表设置
- Vbs知识

```

有一工厂生成一种产品，每一个产品都会进行质量检测，每个产品检测10个点（P1-P10），每个点都有其公差和测量值。该工厂有两种测量仪器，输出的测量结果文件也是两种，一种txt文本文件，一种Excel文件，如图5-1所示。其中txt文件内容如图5-2，Excel文件内容如图5-3所示，可以看到数据格式很简单，每一行表示一个测点的数据。

---
```{figure} image/5-1.png
---
width: 100%
align: center
---
```
<br />
<center>图5-1 测量结果文件</center>

---
```{figure} image/5-2.png
---
width: 100%
align: center
---
```
<br />
<center>图5-2 TXT文本文件</center>

---
```{figure} image/5-3.png
---
width: 100%
align: center
---
```
<br />
<center>图5-3 Excel文件</center>

---
<br />

Excel或者TXT文件的命名规则为：Time-生产时间，如Time-20200503103020.txt文件对应该零件的生产时间为2020/05/03 10:30:20，将该文件名设置为该零件的唯一ID号。

本项目的目标是每测量一件，若数据库中有5次以上数据，自动分发预警邮件。预警邮件的附件Excel中含有该零件质量特性合格率信息是否达标，超差点识别及折线图。当有多个超差点时只展示Top3的问题（按测量值从大到小排序），当只有一个问题点时，折线图需同时展示该点上下公差信息，示例如图5-4所示。

---
```{figure} image/5-4.png
---
width: 100%
align: center
---
```
<br />
<center>图5-4 预警邮件附件示例</center>

---
<br />