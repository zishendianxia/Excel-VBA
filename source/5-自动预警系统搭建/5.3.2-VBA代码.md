# 5.3.2-VBA代码

本示例的核心还是**监控系统.xlsm**中包含的VBA代码。因为代码量比较多，为了方便后续的管理，将其分为4个模块，如图5-9所示。具体代码结构如图5-10所示，代码较多，就不把所有代码一次性贴出来了，后续逐模块讲解。

- 1）模块main：只包含一个Sub，作为启动模块
- 2）模块L1_文件解析：承担文件的解析
- 3）模块L2_预警Excel文件生成：生成预警邮件包含的Excel附件
- 4）模块L3_邮件发送：发送邮件

---
```{figure} image/5-9.png
---
width: 100%
align: center
---
```
<br />
<center>图5-9 模块分布</center>

---
```{figure} image/5-10.png
---
width: 100%
align: center
---
```
<br />
<center>图5-10 VBA代码结构</center>

---
<br />

