# 3.4.4-代码调试

写代码的过程中难免有错误，那么如何发现这些错误呢？这里介绍几个调试支持工具：

**逐语句调试**：平常代码点击运行，瞬间结束，完全不知道过程。通过手动点击一行一行运行判断代码是不是按照预期的方式运行。将鼠标定位到拟运行的Sub过程，点击调试工具栏的逐语句按钮，如图3-10所示

---
```{figure} image/3-10.png
---
width: 100%
align: center
---
```
<br />
<center>图3-10 调试工具栏逐语句运行</center>

---
<br />

**本地窗口**：代码调试过程中，可以看到每个变量的取值及数据类型。执行逐行调试时，打开本地窗口，就可以看见每个变量的最新取值，如图3-11所示。本地窗口包括3列：表达式、值、类型

---
```{figure} image/3-11.png
---
width: 100%
align: center
---
```
<br />
<center>图3-11 本地窗口</center>

---
<br />

**断点**：一行一行运行代码有的时候太累，直接将代码运行可能出错的前几步，然后再分步运行。点击调试工具栏上的运行子过程按钮后，会运行到第一个断点处停下来。如果有多个断点，再点击运行子过程按钮，会运行到当前过程（或者通过Call进入下个Sub）的下个断点处。设置断点的方法，鼠标左键点击图3-12红点区域即可，在鼠标点击所在行设置断点，不同行点击即在不同行设置断点。

---
```{figure} image/3-12.png
---
width: 100%
align: center
---
```
<br />
<center>图3-12 断点调试口</center>

---
<br />

**立即窗口**：本地窗口只保留变量的最新取值，如果想将过程数据打印出来，可以使用Debug.Print将变量取值输出到立即窗口，如图3-13所示。如果发现找不到立即窗口，可以通过菜单视图-选择立即窗口

---
```{figure} image/3-13.png
---
width: 100%
align: center
---
```
<br />
<center>图3-13 立即窗口</center>

---
<br />